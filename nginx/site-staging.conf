server {
  listen 80;
  server_name app-dev.mydomain.com;
  root /usr/share/nginx/html;
  index index.html;

  # Block indexing from the server side (belt & suspenders)
  add_header X-Robots-Tag "noindex, nofollow" always;

  # Health
  location = /health { return 200 "ok"; add_header Content-Type text/plain; }

  # Same clean-URL & caching rules as prod
  location ~ ^(.+)/$ { return 301 $1$is_args$args; }
  location ~* \.(?:css|js|mjs|map|json|png|jpg|jpeg|gif|ico|svg|webp|avif|woff2?|ttf)$ {
    access_log off; expires 1y;
    add_header Cache-Control "public, max-age=31536000, immutable";
    try_files $uri =404;
  }
  location ~* ^/(?:sitemap\.xml|robots\.txt)$ {
    expires 5m; add_header Cache-Control "public, max-age=300";
    try_files $uri =404;
  }
  location / { try_files $uri $uri.html $uri/index.html =404; }
}
